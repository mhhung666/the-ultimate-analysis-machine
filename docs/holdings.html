<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投資組合分析 - 2025-12-13 | The Ultimate Analysis System</title>
    <meta name="description" content="Markdown 報告自動轉換的 Holdings Analysis">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="notion-theme page-holdings" id="theme-typography">
    <div class="page-shell">
        <nav class="top-nav">
            <span class="nav-brand">📊 The Ultimate Analysis System</span>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="market.html" class="nav-link">Market</a>
                <a href="holdings.html" class="nav-link active">Holdings</a>
                <a href="stocks/index.html" class="nav-link">Stocks</a>
            </div>
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle" aria-label="切換主題" title="Toggle theme">
                    <span id="themeIcon">☀️</span>
                </button>
            </div>
        </nav>

        <header class="report-hero">
            <div>
                <p class="eyebrow">Holdings Analysis</p>
                <h1>投資組合分析</h1>
                <p class="hero-note">更新於 2025-12-13</p>
                <div class="hero-meta">
                    <span class="pill">📅 2025-12-13</span>
                    <span class="pill pill-ghost">🕐 2025-12-13 23:58 CST+0800</span>
                    <span class="pill pill-outline">📊 Holdings Analysis</span>
                </div>
            </div>
        </header>

        <main class="page-layout no-toc">
            <section class="content" id="mainContent">
<h2 id="組合概況">📊 組合概況</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>項目</th>
<th>數值</th>
<th>狀態</th>
</tr>
</thead>
<tbody>
<tr>
<td>總資產淨值</td>
<td>$264,079.47</td>
<td>-</td>
</tr>
<tr>
<td>股票市值</td>
<td>$227,956.34 (86.3%)</td>
<td>🟢</td>
</tr>
<tr>
<td>現金餘額</td>
<td>$38,891.48 (14.7%)</td>
<td>🟢</td>
</tr>
<tr>
<td>未實現損益</td>
<td>-$8,023.13 (<span class="status-negative">-3.4%</span>)</td>
<td>🔴</td>
</tr>
<tr>
<td>週變化</td>
<td><span class="status-negative">-0.65%</span></td>
<td>🔴</td>
</tr>
</tbody>
</table></div>
<p><strong>關鍵提示</strong>: 組合本週小幅下跌 0.65%，主要受科技股回調影響。ORCL 新增持倉，12/19 大量選擇權即將到期需密切關注。</p>
<hr>
<h2 id="選擇權部位">🎯 選擇權部位</h2>
<p><strong>到期日: 2025-12-19（6 天後）</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>標的</th>
<th>類型</th>
<th>數量</th>
<th>行權價</th>
<th>當前價</th>
<th>價內/價外</th>
<th>處理建議</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ALK</strong></td>
<td>Sell Call</td>
<td>-1</td>
<td>$47.50</td>
<td>$51.40</td>
<td>⚠️ 價內 $3.90</td>
<td><strong>高風險</strong>：股票將被 call 走，考慮回補或滾倉</td>
</tr>
<tr>
<td><strong>OPCH</strong></td>
<td>Sell Call</td>
<td>-1</td>
<td>$30.00</td>
<td>$33.24</td>
<td>⚠️ 價內 $3.24</td>
<td><strong>高風險</strong>：股票將被 call 走，考慮回補或滾倉</td>
</tr>
<tr>
<td>ALK</td>
<td>Sell Put</td>
<td>-2</td>
<td>$37.50</td>
<td>$51.40</td>
<td>✅ 價外安全</td>
<td>大概率到期歸零，保留權利金</td>
</tr>
<tr>
<td>UPST</td>
<td>Sell Call</td>
<td>-1</td>
<td>$52.00</td>
<td>$49.35</td>
<td>✅ 價外 $2.65</td>
<td>安全距離 5.4%，可持有至到期</td>
</tr>
<tr>
<td>UPST</td>
<td>Sell Call</td>
<td>-2</td>
<td>$54.00</td>
<td>$49.35</td>
<td>✅ 價外 $4.65</td>
<td>安全距離 9.4%，可持有至到期</td>
</tr>
<tr>
<td>UPS</td>
<td>Sell Put</td>
<td>-1</td>
<td>$90.00</td>
<td>$100.92</td>
<td>✅ 價外安全</td>
<td>大概率到期歸零，保留權利金</td>
</tr>
<tr>
<td>UPS</td>
<td>Sell Call</td>
<td>-1</td>
<td>$105.00</td>
<td>$100.92</td>
<td>✅ 價外 $4.08</td>
<td>安全距離 4.0%，可持有至到期</td>
</tr>
<tr>
<td>OSCR</td>
<td>Sell Call</td>
<td>-2</td>
<td>$18.00</td>
<td>$16.63</td>
<td>✅ 價外 $1.37</td>
<td>安全距離 8.2%，可持有至到期</td>
</tr>
<tr>
<td>AMRZ</td>
<td>Sell Call</td>
<td>-2</td>
<td>$55.00</td>
<td>$56.26</td>
<td>⚠️ 輕微價內 $1.26</td>
<td><strong>注意監控</strong>：輕微價內，觀察下週走勢</td>
</tr>
<tr>
<td>DKNG</td>
<td>Sell Call</td>
<td>-1</td>
<td>$37.50</td>
<td>$35.52</td>
<td>✅ 價外 $1.98</td>
<td>安全距離 5.6%，可持有至到期</td>
</tr>
</tbody>
</table></div>
<p><strong>重點關注</strong>:
- 🚨 <strong>ALK Call $47.50</strong>: 深度價內 $3.90，100 股將被 call 走，潛在損失 $(51.40-47.50) × 100 = $390
- 🚨 <strong>OPCH Call $30.00</strong>: 深度價內 $3.24，100 股將被 call 走，鎖定獲利 $(30.00-28.01) × 100 = $199
- ⚠️ <strong>AMRZ Call $55.00</strong>: 輕微價內，需監控下週走勢，若繼續上漲 200 股將被 call 走</p>
<p><strong>處理建議</strong>:
1. <strong>ALK</strong>: 考慮回補 Call 或接受股票被 call 走（成本 $40，call 價 $47.50，仍有 18.75% 利潤）
2. <strong>OPCH</strong>: 可接受股票被 call 走鎖定 7.1% 獲利
3. <strong>AMRZ</strong>: 持續監控，若下週回落至 $55 以下則安全</p>
<hr>
<h2 id="持股狀況">📈 持股狀況</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>股票</th>
<th>持股</th>
<th>成本</th>
<th>現價</th>
<th>損益</th>
<th>倉位</th>
<th>今日</th>
<th>選擇權</th>
<th>狀態</th>
</tr>
</thead>
<tbody>
<tr>
<td>GOOGL</td>
<td>130</td>
<td>$267.98</td>
<td>$309.29</td>
<td><span class="status-positive">+15.4%</span></td>
<td>15.7%</td>
<td><span class="status-negative">-1.01%</span></td>
<td>無</td>
<td>🟢 核心獲利</td>
</tr>
<tr>
<td>U</td>
<td>820</td>
<td>$50.39</td>
<td>$46.16</td>
<td><span class="status-negative">-8.4%</span></td>
<td>14.2%</td>
<td><span class="status-negative">-6.24%</span></td>
<td>無</td>
<td>🔴 重挫需關注</td>
</tr>
<tr>
<td>INTC</td>
<td>800</td>
<td>$45.82</td>
<td>$37.81</td>
<td><span class="status-negative">-17.5%</span></td>
<td>12.5%</td>
<td><span class="status-negative">-4.30%</span></td>
<td>無</td>
<td>🔴 深度虧損</td>
</tr>
<tr>
<td>AMRZ</td>
<td>400</td>
<td>$53.08</td>
<td>$56.26</td>
<td><span class="status-positive">+6.0%</span></td>
<td>8.3%</td>
<td><span class="status-negative">-0.12%</span></td>
<td>有</td>
<td>🟢 獲利但有 Call</td>
</tr>
<tr>
<td>ORCL</td>
<td>100</td>
<td>$191.51</td>
<td>$189.97</td>
<td><span class="status-negative">-0.8%</span></td>
<td>7.2%</td>
<td><span class="status-negative">-4.47%</span></td>
<td>無</td>
<td>🔴 新倉遇跌</td>
</tr>
<tr>
<td>UPST</td>
<td>300</td>
<td>$49.67</td>
<td>$49.35</td>
<td><span class="status-negative">-0.6%</span></td>
<td>5.3%</td>
<td><span class="status-positive">+0.45%</span></td>
<td>有</td>
<td>🟡 接近平盤</td>
</tr>
<tr>
<td>PINS</td>
<td>500</td>
<td>$33.60</td>
<td>$25.99</td>
<td><span class="status-negative">-22.6%</span></td>
<td>5.0%</td>
<td><span class="status-negative">-3.31%</span></td>
<td>無</td>
<td>🔴 嚴重虧損</td>
</tr>
<tr>
<td>UPS</td>
<td>100</td>
<td>$92.00</td>
<td>$100.92</td>
<td><span class="status-positive">+9.7%</span></td>
<td>3.6%</td>
<td><span class="status-positive">+0.44%</span></td>
<td>有</td>
<td>🟢 穩健獲利</td>
</tr>
<tr>
<td>TSLA</td>
<td>20</td>
<td>$298.88</td>
<td>$458.96</td>
<td><span class="status-positive">+53.6%</span></td>
<td>3.4%</td>
<td><span class="status-positive">+2.71%</span></td>
<td>無</td>
<td>🟢 大幅獲利</td>
</tr>
<tr>
<td>MTN</td>
<td>50</td>
<td>$163.76</td>
<td>$161.76</td>
<td><span class="status-negative">-1.2%</span></td>
<td>2.7%</td>
<td><span class="status-positive">+4.49%</span></td>
<td>無</td>
<td>🟡 今日反彈</td>
</tr>
<tr>
<td>ALK</td>
<td>100</td>
<td>$40.00</td>
<td>$51.40</td>
<td><span class="status-positive">+28.5%</span></td>
<td>1.9%</td>
<td><span class="status-negative">-2.19%</span></td>
<td>有</td>
<td>🟢 獲利但有 Call 風險</td>
</tr>
<tr>
<td>OSCR</td>
<td>200</td>
<td>$18.50</td>
<td>$16.63</td>
<td><span class="status-negative">-10.1%</span></td>
<td>1.3%</td>
<td><span class="status-positive">+4.79%</span></td>
<td>有</td>
<td>🔴 虧損但反彈</td>
</tr>
<tr>
<td>DKNG</td>
<td>100</td>
<td>$35.01</td>
<td>$35.52</td>
<td><span class="status-positive">+1.5%</span></td>
<td>1.3%</td>
<td><span class="status-positive">+1.81%</span></td>
<td>有</td>
<td>🟢 微幅獲利</td>
</tr>
<tr>
<td>OPCH</td>
<td>100</td>
<td>$28.01</td>
<td>$33.24</td>
<td><span class="status-positive">+18.7%</span></td>
<td>1.1%</td>
<td><span class="status-positive">+1.03%</span></td>
<td>有</td>
<td>🟢 獲利但有 Call 風險</td>
</tr>
<tr>
<td>MBLY</td>
<td>200</td>
<td>$17.00</td>
<td>$11.07</td>
<td><span class="status-negative">-34.9%</span></td>
<td>0.9%</td>
<td><span class="status-negative">-2.89%</span></td>
<td>無</td>
<td>🔴 嚴重虧損</td>
</tr>
</tbody>
</table></div>
<p><strong>持股分析</strong>:</p>
<h3 id="需立即關注">🚨 需立即關注</h3>
<h4 id="u-unity-software---142-倉位">📊 U (Unity Software) - 14.2% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 今日重挫 <span class="status-negative">-6.24%</span>，總損失 <span class="status-negative">-8.4%</span>（-$3,781）</li>
<li><strong>原因</strong>: 820 股為最大單一持倉，跌幅影響組合約 <span class="status-negative">-0.88%</span></li>
<li><strong>建議</strong>: 觀察 $45 支撐，若跌破考慮止損或減倉至 10% 以下</li>
<li><strong>風險</strong>: 遊戲引擎市場競爭加劇，Unity 5.0 進展需關注</li>
</ul>
<h4 id="intc-intel---125-倉位">📊 INTC (Intel) - 12.5% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 今日下跌 <span class="status-negative">-4.30%</span>，總損失 <span class="status-negative">-17.5%</span>（-$14,032）</li>
<li><strong>原因</strong>: 半導體產業整體回調，AI 晶片競爭落後</li>
<li><strong>建議</strong>: 第二大持倉陷入深度虧損，建議減倉至 8% 以下</li>
<li><strong>風險</strong>: 與 NVDA/AMD 差距擴大，轉型進度緩慢</li>
</ul>
<h4 id="pins-pinterest---50-倉位">📊 PINS (Pinterest) - 5.0% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 今日下跌 <span class="status-negative">-3.31%</span>，總損失 <span class="status-negative">-22.6%</span>（-$3,805）</li>
<li><strong>建議</strong>: 嚴重虧損，建議止損或設定 $24 停損點</li>
<li><strong>風險</strong>: 廣告營收成長放緩，用戶增長停滯</li>
</ul>
<h4 id="orcl-oracle---72-倉位">📊 ORCL (Oracle) - 7.2% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 新開倉即遇 <span class="status-negative">-4.47%</span> 重挫，總損失 <span class="status-negative">-0.8%</span>（-$154）</li>
<li><strong>原因</strong>: 根據觀察清單新聞，市場擔憂 ORCL 對 OpenAI 的 $300B 投資依賴</li>
<li><strong>建議</strong>: 觀察下週穩定性，$185 為關鍵支撐</li>
<li><strong>風險</strong>: AI 雲端服務競爭激烈，對單一客戶依賴度高</li>
</ul>
<h3 id="表現優異">🟢 表現優異</h3>
<h4 id="tsla-tesla---34-倉位">📊 TSLA (Tesla) - 3.4% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 今日上漲 <span class="status-positive">+2.71%</span>，總獲利 <span class="status-positive">+53.6%</span>（+$3,202）</li>
<li><strong>建議</strong>: 考慮部分獲利了結或設定移動停損保護利潤</li>
<li><strong>評估</strong>: 小倉位大獲利，可維持或適度加碼至 5%</li>
</ul>
<h4 id="googl-alphabet---157-倉位">📊 GOOGL (Alphabet) - 15.7% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 最大持倉，獲利 <span class="status-positive">+15.4%</span>（+$6,176）</li>
<li><strong>建議</strong>: 核心持倉表現穩健，可繼續持有</li>
<li><strong>評估</strong>: AI 搜尋與雲端業務增長穩定</li>
</ul>
<h4 id="alk-alaska-air---19-倉位">📊 ALK (Alaska Air) - 1.9% 倉位</h4>
<ul>
<li><strong>狀態</strong>: 獲利 <span class="status-positive">+28.5%</span>（+$1,140），但有 Call $47.50 價內風險</li>
<li><strong>建議</strong>: 6 天後股票可能被 call 走，鎖定 18.75% 利潤</li>
<li><strong>評估</strong>: 航空股復甦，被 call 走也是理想結果</li>
</ul>
<hr>
<h2 id="績效追蹤">📊 績效追蹤</h2>
<h3 id="本週績效1205---1213">本週績效（12/05 - 12/13）</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>指標</th>
<th>數值</th>
<th>評估</th>
</tr>
</thead>
<tbody>
<tr>
<td>週度報酬率</td>
<td><span class="status-negative">-0.65%</span></td>
<td>🔴</td>
</tr>
<tr>
<td>淨值變化</td>
<td>-$1,719.76</td>
<td>🔴</td>
</tr>
<tr>
<td>最佳持股</td>
<td>TSLA (<span class="status-positive">+2.71%</span>)</td>
<td>🟢</td>
</tr>
<tr>
<td>最差持股</td>
<td>U (<span class="status-negative">-6.24%</span>)</td>
<td>🔴</td>
</tr>
<tr>
<td>科技股拖累</td>
<td>INTC (<span class="status-negative">-4.30%</span>), ORCL (<span class="status-negative">-4.47%</span>)</td>
<td>🔴</td>
</tr>
</tbody>
</table></div>
<p><strong>週度分析</strong>:
- 本週小幅回檔主要受科技股普遍回調影響
- 持股市值減少 $17,282.82，但現金減少 $18,481.97（用於建倉 ORCL）
- 保證金緩衝從 79.57% 降至 77.90%，仍屬非常安全範圍</p>
<h3 id="年度績效假設初始資金-260000">年度績效（假設初始資金 $260,000）</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>指標</th>
<th>數值</th>
</tr>
</thead>
<tbody>
<tr>
<td>年度報酬率</td>
<td><span class="status-positive">+1.57%</span></td>
</tr>
<tr>
<td>未實現損益</td>
<td>-$8,023.13 (<span class="status-negative">-3.4%</span>)</td>
</tr>
<tr>
<td>實現損益（選擇權）</td>
<td>估計 +$13,000</td>
</tr>
</tbody>
</table></div>
<hr>
<h2 id="觀察清單分析">👀 觀察清單分析</h2>
<h3 id="觀察標的概況">📊 觀察標的概況</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>股票</th>
<th>當前價</th>
<th>今日漲跌</th>
<th>新聞情緒</th>
<th>評估</th>
</tr>
</thead>
<tbody>
<tr>
<td>AVGO</td>
<td>$359.93</td>
<td><span class="status-negative">-11.43%</span></td>
<td>🔴 負面</td>
<td>AI 晶片獲利疑慮，暫不建倉</td>
</tr>
</tbody>
</table></div>
<h3 id="重點觀察標的">重點觀察標的</h3>
<h4 id="avgo-broadcom">📌 AVGO (Broadcom)</h4>
<p><strong>最新動態</strong>:
- 🚨 <strong>暴跌 <span class="status-negative">-11.43%</span></strong>：單日重挫 $46.44，市值蒸發 $79B
- 📰 <strong>市場擔憂 AI 泡沫</strong>：投資者對 AI 晶片獲利能力產生懷疑
- 📊 <strong>分析師態度分歧</strong>：部分分析師上調預期，但市場反應負面
- 🔄 <strong>資金輪動</strong>：大型科技股資金流向週期性股票與小型股</p>
<p><strong>價格表現</strong>:
- 開盤 $379.96，最高 $380.92，最低 $355.15
- 成交量暴增至 91.37M，遠超正常水平
- 技術面跌破多條均線支撐</p>
<p><strong>投資價值</strong>:
- ⚠️ <strong>暫不建議建倉</strong>：
  - AI 晶片業務雖成長，但市場信心動搖
  - 估值仍處高位（市值 $1.7T）
  - 需觀察是否形成底部支撐
- 📍 <strong>潛在進場點</strong>：若跌至 $320-330 區間可考慮小倉位試探
- 🎯 <strong>長期前景</strong>：AI 加速器業務仍有成長空間，但短期需消化賣壓</p>
<p><strong>風險因素</strong>:
- AI 投資熱潮降溫可能持續
- 與 NVDA 競爭加劇
- 宏觀經濟與 Fed 政策影響科技股估值</p>
<p><strong>結論</strong>: 觀察為主，等待市場情緒穩定後再評估。目前組合已有 INTC、ORCL 等半導體/科技曝險，無需急於加倉 AVGO。</p>
<hr>
<h2 id="投資組合建議">💡 投資組合建議</h2>
<h3 id="立即行動項目">立即行動項目</h3>
<ol>
<li>
<p><strong>12/19 選擇權到期處理</strong>（6 天後）:
   - ALK Call $47.50: 決定是否回補或接受被 call 走
   - OPCH Call $30.00: 接受被 call 走鎖定利潤
   - AMRZ Call $55.00: 密切監控，考慮回補</p>
</li>
<li>
<p><strong>虧損部位檢討</strong>:
   - INTC: 考慮減倉至 8% 以下（目前虧損 -$14,032）
   - PINS: 設定止損點 $24，或直接止損出場
   - MBLY: 小倉位深度虧損 <span class="status-negative">-34.9%</span>，考慮認賠</p>
</li>
<li>
<p><strong>獲利部位管理</strong>:
   - TSLA: 設定移動停損 $420，保護 <span class="status-positive">+53.6%</span> 利潤
   - GOOGL: 核心持倉，繼續持有</p>
</li>
</ol>
<h3 id="倉位優化建議">倉位優化建議</h3>
<ul>
<li><strong>減碼</strong>: INTC (12.5% → 8%), U (14.2% → 10%)</li>
<li><strong>加碼</strong>: GOOGL 可維持，TSLA 可考慮加至 5%</li>
<li><strong>觀察</strong>: ORCL 新倉需 1-2 週穩定期</li>
</ul>
<h3 id="風險管理">風險管理</h3>
<ul>
<li>保證金緩衝 77.9% 健康，但需注意選擇權到期對現金的影響</li>
<li>現金比例 14.7% 充足，可應對選擇權履約需求</li>
<li>建議維持 10-15% 現金比例以保持彈性</li>
</ul>
<hr>
<h2 id="免責聲明">⚠️ 免責聲明</h2>
<p>本報告僅供參考,不構成投資建議。投資有風險,請根據自身情況做出獨立決策。</p>
<hr>
<p><strong>分析引擎</strong>: Claude (Sonnet 4.5)<br>
<strong>報告版本</strong>: v2.1</p>
            </section>
        </main>

        <button class="back-to-top" id="backToTop" aria-label="回到頂部" title="Back to top">↑</button>

        <footer>
            <p>The Ultimate Analysis System | MH Hung © 2025</p>
        </footer>
    </div>

    <script>
        // 主題切換 (Notion-style)
        function getPreferredTheme() {
            const stored = localStorage.getItem('mis-theme');
            if (stored === 'light' || stored === 'dark') return stored;
            // Notion 預設為淺色模式
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function applyTheme(theme) {
            const body = document.body;
            body.classList.toggle('theme-light', theme === 'light');
            body.classList.toggle('theme-dark', theme === 'dark');
            localStorage.setItem('mis-theme', theme);

            const icon = document.getElementById('themeIcon');
            if (icon) {
                icon.textContent = theme === 'light' ? '🌙' : '☀️';
            }

            const toggle = document.getElementById('themeToggle');
        if (toggle) {
            toggle.setAttribute('aria-label', `切換為${theme === 'light' ? '深色' : '淺色'}模式`);
        }
    }

        // Mobile nav toggle
        function setupMobileNav() {
            const nav = document.querySelector('.top-nav');
            const navLinks = nav?.querySelector('.nav-links');
            const navActions = nav?.querySelector('.nav-actions');
            const navBrand = nav?.querySelector('.nav-brand');
            if (!nav || !navLinks || !navActions || !navBrand) return;

            let toggle = document.getElementById('menuToggle');
            if (!toggle) {
                toggle = document.createElement('button');
                toggle.id = 'menuToggle';
                toggle.type = 'button';
                toggle.className = 'menu-toggle';
                toggle.setAttribute('aria-label', '開啟選單');
                toggle.setAttribute('aria-expanded', 'false');
                toggle.textContent = '☰';
                nav.insertBefore(toggle, navBrand);
            }

            let backdrop = document.getElementById('navBackdrop');
            if (!backdrop) {
                backdrop = document.createElement('div');
                backdrop.id = 'navBackdrop';
                backdrop.className = 'nav-backdrop';
                document.body.appendChild(backdrop);
            }

            const closeNav = () => {
                document.body.classList.remove('nav-open');
                toggle.setAttribute('aria-expanded', 'false');
            };

            const openNav = () => {
                document.body.classList.add('nav-open');
                toggle.setAttribute('aria-expanded', 'true');
            };

            toggle.addEventListener('click', () => {
                const isOpen = document.body.classList.contains('nav-open');
                isOpen ? closeNav() : openNav();
            });

            backdrop.addEventListener('click', closeNav);
            navLinks.addEventListener('click', (event) => {
                if (event.target instanceof HTMLElement && event.target.tagName === 'A') {
                    closeNav();
                }
            });

            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    closeNav();
                }
            });

            document.body.classList.add('nav-ready');
        }

        // Back to top
        function handleBackToTop() {
            const btn = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                btn.classList.add('visible');
            } else {
                btn.classList.remove('visible');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            applyTheme(getPreferredTheme());
            handleBackToTop();

            let scrollTimeout;
            window.addEventListener('scroll', () => {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    handleBackToTop();
                }, 100);
            });

            document.getElementById('backToTop').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    const nextTheme = document.body.classList.contains('theme-light') ? 'dark' : 'light';
                    applyTheme(nextTheme);
                });
            }

            setupMobileNav();
        });
    </script>
</body>
</html>
